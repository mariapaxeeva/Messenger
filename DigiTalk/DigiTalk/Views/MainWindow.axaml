<!--Главное окно мессенджера-->
<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
		xmlns:vm="using:DigiTalk.ViewModels"
		Icon="/Assets/logo.ico"
		mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600"
        x:Class="DigiTalk.Views.MainWindow"
        x:DataType="vm:MainViewModel"
		Title="DigiTalk"
        MinWidth="600" MinHeight="450">
	<Grid RowDefinitions="Auto,*,Auto">
		<!-- Заголовок -->
		<Border Grid.Row="0" Background="#a34beb" Padding="10">
			<TextBlock Text="DigiTalk" FontSize="20" Foreground="White"
                       HorizontalAlignment="Center"/>
		</Border>

		<!-- Основное содержимое -->
		<Grid Grid.Row="1">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="200"/>
				<ColumnDefinition Width="*"/>
			</Grid.ColumnDefinitions>

			<!-- Список контактов -->
			<StackPanel Grid.Column="0" Background="#f5f5f5">
				<StackPanel Orientation="Horizontal">
					<Button Content="Log in" Margin="5" Command="{Binding LoginCommand}"
						    CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}"/>
					<Button Content="Refresh" Command="{Binding RefreshContactsCommand}"/>
				</StackPanel>
				<ListBox ItemsSource="{Binding Contacts}" SelectedItem="{Binding SelectedContact}">
					<ListBox.ItemTemplate>
						<DataTemplate>
							<StackPanel Orientation="Horizontal">
								<Ellipse Width="10" Height="10" Fill="#a34beb"
                                         VerticalAlignment="Center" Margin="0,0,5,0"/>
								<TextBlock Text="{Binding Name}" />
							</StackPanel>
						</DataTemplate>
					</ListBox.ItemTemplate>
				</ListBox>
			</StackPanel>

			<!-- Чат -->
			<Grid Grid.Column="1">
				<Grid.RowDefinitions>
					<RowDefinition Height="*"/>
					<RowDefinition Height="Auto"/>
				</Grid.RowDefinitions>

				<!-- Сообщения -->
				<ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
					<ItemsControl ItemsSource="{Binding Messages}">
						<ItemsControl.ItemTemplate>
							<DataTemplate>
								<Border Margin="5" CornerRadius="5"
                                        Background="{Binding IsOwnMessage, Converter={StaticResource MessageBackgroundConverter}}"
                                        Padding="10" HorizontalAlignment="{Binding IsOwnMessage, Converter={StaticResource MessageAlignmentConverter}}">
									<StackPanel>
										<TextBlock Text="{Binding Sender}" FontWeight="Bold"
                                                   Foreground="{Binding IsOwnMessage, Converter={StaticResource SenderColorConverter}}"/>
										<TextBlock Text="{Binding Content}" TextWrapping="Wrap"/>
										<TextBlock Text="{Binding Timestamp, StringFormat='HH:mm'}"
                                                   FontSize="10" HorizontalAlignment="Right"/>
									</StackPanel>
								</Border>
							</DataTemplate>
						</ItemsControl.ItemTemplate>
					</ItemsControl>
				</ScrollViewer>

				<!-- Поле для ввода сообщений -->
				<Grid Grid.Row="1" Margin="5">
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="*"/>
						<ColumnDefinition Width="Auto"/>
					</Grid.ColumnDefinitions>
					<TextBox Text="{Binding MessageText}" Watermark="Type your message here..."
                             AcceptsReturn="True" VerticalAlignment="Center"/>
					<Button Grid.Column="1" Content="Send" Margin="5,0,0,0"
                            Command="{Binding SendMessageCommand}" Width="80"/>
				</Grid>
			</Grid>
		</Grid>

		<!-- Панель со статусом -->
		<Border Grid.Row="2" Background="#e0e0e0" Padding="5">
			<TextBlock Text="{Binding StatusMessage}"/>
		</Border>
	</Grid>
</Window>